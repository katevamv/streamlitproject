# scRNA-seq Interactive Analysis App

This repository contains a Streamlit application for interactive single-cell RNA-seq (scRNA-seq) data analysis using Scanpy and Harmony integration. The app provides data preprocessing, visualization, differential expression analysis, and batch-correction features.

## Features

* **Preprocessing**: Filter cells and genes, remove ERCC/MT genes, normalize, log-transform, identify highly variable genes (HVGs), scale data, compute PCA, construct neighbor graph, and compute UMAP embeddings.
* **Data Exploration** (Tab 1)
 
  * UMAP plots colored by metadata.
  * PCA plots colored by metadata.
  * HVG visualization.
  * Violin plots for QC metrics (`n_genes_by_counts`, `total_counts`).
  * Bar plots of cell type vs. disease counts.
* **Differential Expression** (Tab 2)

  * Wilcoxon rank-sum test for user-selected grouping.
  * Volcano plot and heatmap of top differentially expressed genes.
  * Interactive table of DE results.
* **Batch Correction** (Tab 3)

  * Harmony integration to correct batch effects.
  * Side-by-side UMAP before and after Harmony.

## Installation

1. Clone this repository:

   ```bash
   git clone https://github.com/yourusername/scrna-seq-streamlit.git
   cd scrna-seq-streamlit
   ```

2. Create a Python virtual environment and activate it:

   ```bash
   python -m venv .venv
   source .venv/bin/activate    # On Linux/macOS
   .\.venv\\Scripts\\activate  # On Windows
   ```

3. Install dependencies:

   ```bash
   pip install -r requirements.txt
   ```

## Usage

1. Place your `.h5ad` file (e.g., `pancreas_data.h5ad`) in the root directory.
2. Run the Streamlit app:

   ```bash
   streamlit run app.py
   ```
3. Open the URL shown in the terminal (usually `http://localhost:8501`) in your web browser.

## File Structure

```
├── app.py              # Main Streamlit application
├── requirements.txt     # Python dependencies
├── pancreas_data.h5ad   # Example AnnData file (not included)
└── README.md            # This documentation
```

## Dependencies

* Python >= 3.8
* [Streamlit](https://streamlit.io/)
* [Scanpy](https://scanpy.readthedocs.io/)
* [Harmony-py](https://github.com/slowkow/harmony-py)
* [Pandas](https://pandas.pydata.org/)
* [Matplotlib](https://matplotlib.org/)
* [Seaborn](https://seaborn.pydata.org/)
* [NumPy](https://numpy.org/)

Install all via:

```bash
pip install streamlit scanpy scanpy_external harmonypy pandas matplotlib seaborn numpy
```

## Customization

* Adjust QC and filtering thresholds via the sidebar sliders.
* Select different metadata fields (e.g., `celltype`, `disease`) for coloring and grouping.
* Modify preprocessing parameters (e.g., `min_genes`, `min_cells`, HVG criteria) in the code.

## Contributing

Contributions are welcome! Feel free to open issues or submit pull requests.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

---

*Generated by the scRNA-seq Interactive Analysis App template.*
